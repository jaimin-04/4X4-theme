{
  "version": 3,
  "sources": ["../../app/scripts/filter.js"],
  "sourcesContent": ["class Filter {\r\n  constructor(container) {\r\n    let dataUrls = container.dataset.urls;\r\n    this.collectionPosition = +container.dataset.collectionPosition;\r\n    this.elms = {\r\n      container: container,\r\n      field1: container.querySelector(\".chosen-container[data-field-index='1']\"),\r\n      field2: container.querySelector(\".chosen-container[data-field-index='2']\"),\r\n      field3: container.querySelector(\".chosen-container[data-field-index='3']\"),\r\n      buttonSubmit: container.querySelector(\".js-btn-submit\"),\r\n      buttonReset: container.querySelector(\".js-btn-reset\"),\r\n    };\r\n    this.getData(dataUrls).then((data) => {\r\n      data = data.flat(2);\r\n      let lastSelect = AT.cookie.get(\"arn-filter\");\r\n      if (!!lastSelect && lastSelect instanceof Array) {\r\n        let [field1Value, field2Value, field3Value] = lastSelect;\r\n        if (!field1Value || !field2Value || !field3Value) {\r\n          AT.cookie.delete(\"arn-filter\");\r\n          this.initField(this.elms.field1, data);\r\n          return;\r\n        }\r\n        let temporaryVariable = data.find((item) => String(item.name).toLowerCase() == field1Value.toLowerCase());\r\n        if (!temporaryVariable) {\r\n          AT.cookie.delete(\"arn-filter\");\r\n          this.initField(this.elms.field1, data);\r\n          return;\r\n        }\r\n        let data2 = temporaryVariable[\"field_2\"];\r\n\r\n        temporaryVariable = data2.find((item) => String(item.name).toLowerCase() == field2Value.toLowerCase());\r\n        if (!temporaryVariable) {\r\n          AT.cookie.delete(\"arn-filter\");\r\n          this.initField(this.elms.field1, data);\r\n          return;\r\n        }\r\n        let data3 = temporaryVariable[\"field_3\"];\r\n        if (!!data2 && !!data3 && data3.some((a) => String(a).toLowerCase() == field3Value.toLowerCase())) {\r\n          this.setField(this.elms.field1, field1Value, data);\r\n          this.setField(this.elms.field2, field2Value, data2);\r\n          this.setField(this.elms.field3, field3Value, data3, true);\r\n        } else {\r\n          this.initField(this.elms.field1, data);\r\n          AT.cookie.delete(\"arn-filter\");\r\n        }\r\n      } else {\r\n        this.initField(this.elms.field1, data);\r\n      }\r\n      this.initEventFieldTitle();\r\n      this.initEventButtonReset();\r\n      this.initEventButtonSubmit();\r\n    });\r\n  }\r\n\r\n  initField(element, data, lastField) {\r\n    let newData = lastField ? data : data.map((item) => item.name);\r\n    let index = element.dataset.fieldIndex;\r\n    let titleElement = element.querySelector(\".js-title\");\r\n\r\n    let chosenResults = element.querySelector(\".chosen-results\");\r\n    let chosenDrop = element.querySelector(\".chosen-drop\");\r\n    chosenResults.innerHTML = \"\";\r\n    newData.forEach((item) => {\r\n      let li = document.createElement(\"li\");\r\n      li.addClass(\"active-result\");\r\n      li.innerHTML = String(item).toUpperCase();\r\n      li.setAttribute(\"data-value\", item);\r\n      chosenResults.append(li);\r\n    });\r\n\r\n    chosenResults.children.addEvents(\"click\", (e) => {\r\n      e.stopPropagation();\r\n      let { target } = e;\r\n      let value = target.dataset.value;\r\n      titleElement.innerHTML = value;\r\n      element.setAttribute(\"data-value\", value);\r\n      chosenDrop.removeClass(\"active\");\r\n      this.change(index, data, value);\r\n    });\r\n  }\r\n\r\n  setField(element, value, data, lastField) {\r\n    this.initField(element, data, lastField);\r\n    element.setAttribute(\"data-value\", value);\r\n    element.querySelector(\".js-title\").innerHTML = value.toUpperCase();\r\n    element.addClass(\"active\");\r\n  }\r\n\r\n  change(index, data, value) {\r\n    let { field2, field3, buttonSubmit } = this.elms;\r\n    switch (index) {\r\n      case \"1\": {\r\n        let newData = data.find((item) => String(item.name).toLowerCase() == value.toLowerCase())[\"field_2\"];\r\n\r\n        this.resetField(field2);\r\n        this.resetField(field3);\r\n\r\n        this.initField(field2, newData);\r\n        field2.addClass(\"active\");\r\n        field2.querySelector(\".chosen-drop\").addClass(\"active\");\r\n        break;\r\n      }\r\n      case \"2\": {\r\n        let newData = data.find((item) => String(item.name).toLowerCase() == value.toLowerCase())[\"field_3\"];\r\n\r\n        this.resetField(field3);\r\n\r\n        this.initField(field3, newData, true);\r\n        field3.addClass(\"active\");\r\n        field3.querySelector(\".chosen-single\").click();\r\n        break;\r\n      }\r\n      case \"3\":\r\n        // buttonSubmit.click();\r\n        break;\r\n    }\r\n  }\r\n\r\n  resetField(element) {\r\n    let title = element.querySelector(\".js-title\");\r\n    element.removeClass(\"active\");\r\n    title.innerHTML = title.dataset.placeholder;\r\n    element.setAttribute(\"data-value\", \"\");\r\n    element.querySelector(\".chosen-results\").innerHTMl = \"\";\r\n  }\r\n\r\n  initEventFieldTitle() {\r\n    let { container } = this.elms;\r\n\r\n    container.querySelectorAll(\".chosen-container\").forEach((fieldContainer) => {\r\n      let filterTitle = fieldContainer.querySelector(\".chosen-single\");\r\n      let inputSearch = fieldContainer.querySelector(\"input[name='search']\");\r\n      let fieldResults = fieldContainer.querySelector(\".chosen-results\");\r\n\r\n      let target = filterTitle.nextElementSibling;\r\n      filterTitle.addEvent(\"click\", () => {\r\n        if (target.hasClass(\"active\")) {\r\n          target.removeClass(\"active\");\r\n        } else {\r\n          target.addClass(\"active\");\r\n        }\r\n      });\r\n\r\n      document.addEvent(\"click\", (e) => {\r\n        if (!filterTitle.parentElement.contains(e.target)) {\r\n          target.removeClass(\"active\");\r\n        }\r\n      });\r\n\r\n      inputSearch.addEvent(\"input\", () => {\r\n        let value = inputSearch.value.toLowerCase();\r\n        fieldResults.children.forEach((item) => {\r\n          if (item.innerHTML.toLowerCase().includes(value)) {\r\n            item.style.display = \"block\";\r\n          } else {\r\n            item.style.display = \"none\";\r\n          }\r\n        });\r\n      });\r\n    });\r\n  }\r\n\r\n  getData(urls) {\r\n    return Promise.all(urls.split(\",\").map((url) => fetch(url, { dataType: \"json\" })));\r\n  }\r\n\r\n  initEventButtonReset() {\r\n    let { field1, field2, field3, buttonReset } = this.elms;\r\n\r\n    buttonReset.addEvent(\"click\", () => {\r\n      this.resetField(field1);\r\n      field1.addClass(\"active\");\r\n      this.resetField(field2);\r\n      this.resetField(field3);\r\n      AT.cookie.delete(\"arn-filter\");\r\n    });\r\n  }\r\n\r\n  initEventButtonSubmit() {\r\n    let { buttonSubmit, field1, field2, field3 } = this.elms;\r\n\r\n    buttonSubmit.addEvent(\"click\", (e) => {\r\n      let optionValues = this.getOptionValues();\r\n      console.log(field1.querySelector(\".chosen-drop\"));\r\n      if (optionValues.filter(Boolean).length < 3) {\r\n        switch (optionValues.filter(Boolean).length) {\r\n          case 0:\r\n            field1.querySelector(\".chosen-drop\").addClass(\"active\");\r\n            break;\r\n          case 1:\r\n            field2.querySelector(\".chosen-drop\").addClass(\"active\");\r\n            break;\r\n          case 2:\r\n            field3.querySelector(\".chosen-drop\").addClass(\"active\");\r\n            break;\r\n        }\r\n        e.stopPropagation();\r\n        return;\r\n      }\r\n      let url = `${theme.routes.collectionsUrl}/${optionValues[this.collectionPosition].convertToSlug()}/${optionValues\r\n        .map((i) => i.convertToSlug())\r\n        .filter((i, index) => this.collectionPosition != index)\r\n        .join(\"+\")}`;\r\n      AT.cookie.set(\"arn-filter\", optionValues, 7);\r\n      window.location.href = url;\r\n    });\r\n  }\r\n\r\n  getOptionValues() {\r\n    let { field1, field2, field3 } = this.elms;\r\n    return [`${field1.dataset.value}`, `${field2.dataset.value}`, `${field3.dataset.value}`];\r\n  }\r\n}\r\n\r\nwindow.Filter = Filter;\r\nconsole.log(\"filter.js loaded\");\r\n"],
  "mappings": "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",
  "names": []
}
