(()=>{var h=class{constructor(s){this.elms={container:s,formContainer:s.querySelector("form[action*='/search']"),inputElement:s.querySelector("input[name='q']"),resultsContanier:s.querySelector(".search-results")},this.initInputEvent()}initInputEvent(){let{inputElement:s,formContainer:u,container:d,resultsContanier:t}=this.elms,a=u.querySelector("button[type='submit']"),r=t.querySelector(".btn-view-all");s.addEvent("blur",()=>{d.removeClass("active")}),s.addEvent("focus",()=>{d.addClass("active")}),s.addEvent("input",AT.debounce(()=>{let o=s.value.trim();!o||(a.addClass("pending"),fetch(`${theme.routes.searchUrl}/suggest.json?q=${o}${theme.settings.search.urlParams}`,{method:"get",dataType:"json",headers:new Headers}).then(v=>{let{resources:i}=v,{products:f,collections:g=[],pages:C=[],articles:E=[]}=i.results,c=Object.keys(i.results).reduce((l,e)=>l+i.results[e].length,0);if(c){let l=[];f.forEach(e=>l.push(`<div class="result-item product">
                  <a href="${e.url}" class="result-image">
                    <img src="${AT.getSizedImageUrl(e.featured_image.url||theme.assets.defaultImage,"100x")}" alt="${e.title}"/>
                  </a>
                  <div class="result-info">
                    <a href="${e.url}" class="result-title">${e.title}</a>
                    <div class="result-price js-money">${e.available?(e.price*100).toCurrency():theme.strings.soldOut}</div>
                  </div>
                </div>`)),g.forEach(e=>l.push(`
            <div class="result-item collection">
              <div class="result-image">
                <img src="${AT.getSizedImageUrl(e.featured_image.url||theme.assets.defaultImage,"100x")}" alt="${e.title}"/>
              </div>
              <div class="result-info">
                <a href="${e.url}" class="result-title">${e.title}</a>
              </div>
            </div>
            `)),E.forEach(e=>l.push(`
              <div class="result-item article">
                <a href="${e.url}" class="result-title">${e.title}</a>
              </div>
              `)),C.forEach(e=>l.push(`
              <div class="result-item page">
                <a href="${e.url}" class="result-title">${e.title}</a>
              </div>`)),c>10?r.removeClass("d-none"):r.addClass("d-none"),Promise.all(l).then(e=>{t.querySelectorAll(".result-item").forEach(n=>n.remove()),e.forEach(n=>{let m=document.createElement("div");m.innerHTML=n,r.insertAdjacentElement("beforebegin",m.firstElementChild)}),typeof Currencies!="undefined"&&t.getElementsByClassName("js-money").forEach(Currencies.registerObserve.bind(Currencies)),a.removeClass("pending"),t.addClass("has-results"),t.removeClass("no-results")})}else t.removeClass("has-results"),t.addClass("no-results"),a.removeClass("pending")}))},500)),r.addEvent("click",()=>u.submit())}};window.Search=h;})();
