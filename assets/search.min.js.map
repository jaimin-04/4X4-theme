{
  "version": 3,
  "sources": ["../../app/scripts/search.js"],
  "sourcesContent": ["class Search {\r\n  constructor(container) {\r\n    this.elms = {\r\n      container: container,\r\n      formContainer: container.querySelector(\"form[action*='/search']\"),\r\n      inputElement: container.querySelector(\"input[name='q']\"),\r\n      resultsContanier: container.querySelector(\".search-results\"),\r\n    };\r\n\r\n    this.initInputEvent();\r\n  }\r\n\r\n  initInputEvent() {\r\n    let { inputElement, formContainer, container, resultsContanier } = this.elms;\r\n    let buttonSubmit = formContainer.querySelector(\"button[type='submit']\");\r\n    let buttonViewAll = resultsContanier.querySelector(\".btn-view-all\");\r\n\r\n    inputElement.addEvent(\"blur\", () => {\r\n      container.removeClass(\"active\");\r\n    });\r\n    inputElement.addEvent(\"focus\", () => {\r\n      container.addClass(\"active\");\r\n    });\r\n\r\n    inputElement.addEvent(\r\n      \"input\",\r\n      AT.debounce(() => {\r\n        let value = inputElement.value.trim();\r\n        if (!value) {\r\n          return;\r\n        }\r\n        buttonSubmit.addClass(\"pending\");\r\n\r\n        fetch(`${theme.routes.searchUrl}/suggest.json?q=${value}${theme.settings.search.urlParams}`, {\r\n          method: \"get\",\r\n          dataType: \"json\",\r\n          headers: new Headers(),\r\n        }).then((data) => {\r\n          let { resources } = data;\r\n          let { products, collections = [], pages = [], articles = [] } = resources.results;\r\n\r\n          let resultsCount = Object.keys(resources.results).reduce((accu, value) => {\r\n            return accu + resources.results[value].length;\r\n          }, 0);\r\n          if (resultsCount) {\r\n            let arrPromise = [];\r\n            products.forEach((product) =>\r\n              arrPromise.push(\r\n                `<div class=\"result-item product\">\r\n                  <a href=\"${product.url}\" class=\"result-image\">\r\n                    <img src=\"${AT.getSizedImageUrl(\r\n                      product.featured_image.url || theme.assets.defaultImage,\r\n                      \"100x\",\r\n                    )}\" alt=\"${product.title}\"/>\r\n                  </a>\r\n                  <div class=\"result-info\">\r\n                    <a href=\"${product.url}\" class=\"result-title\">${product.title}</a>\r\n                    <div class=\"result-price js-money\">${\r\n                      product.available ? (product.price * 100).toCurrency() : theme.strings.soldOut\r\n                    }</div>\r\n                  </div>\r\n                </div>`,\r\n              ),\r\n            );\r\n\r\n            collections.forEach((collection) =>\r\n              arrPromise.push(`\r\n            <div class=\"result-item collection\">\r\n              <div class=\"result-image\">\r\n                <img src=\"${AT.getSizedImageUrl(\r\n                  collection.featured_image.url || theme.assets.defaultImage,\r\n                  \"100x\",\r\n                )}\" alt=\"${collection.title}\"/>\r\n              </div>\r\n              <div class=\"result-info\">\r\n                <a href=\"${collection.url}\" class=\"result-title\">${collection.title}</a>\r\n              </div>\r\n            </div>\r\n            `),\r\n            );\r\n\r\n            articles.forEach((article) =>\r\n              arrPromise.push(`\r\n              <div class=\"result-item article\">\r\n                <a href=\"${article.url}\" class=\"result-title\">${article.title}</a>\r\n              </div>\r\n              `),\r\n            );\r\n\r\n            pages.forEach((page) =>\r\n              arrPromise.push(`\r\n              <div class=\"result-item page\">\r\n                <a href=\"${page.url}\" class=\"result-title\">${page.title}</a>\r\n              </div>`),\r\n            );\r\n\r\n            resultsCount > 10 ? buttonViewAll.removeClass(\"d-none\") : buttonViewAll.addClass(\"d-none\");\r\n            Promise.all(arrPromise).then((data) => {\r\n              resultsContanier.querySelectorAll(\".result-item\").forEach((item) => item.remove());\r\n              data.forEach((element) => {\r\n                let div = document.createElement(\"div\");\r\n                div.innerHTML = element;\r\n                buttonViewAll.insertAdjacentElement(\"beforebegin\", div.firstElementChild);\r\n              });\r\n              if (typeof Currencies !== \"undefined\") {\r\n                resultsContanier\r\n                  .getElementsByClassName(\"js-money\")\r\n                  .forEach(Currencies.registerObserve.bind(Currencies));\r\n              }\r\n              buttonSubmit.removeClass(\"pending\");\r\n              resultsContanier.addClass(\"has-results\");\r\n              resultsContanier.removeClass(\"no-results\");\r\n            });\r\n          } else {\r\n            resultsContanier.removeClass(\"has-results\");\r\n            resultsContanier.addClass(\"no-results\");\r\n            buttonSubmit.removeClass(\"pending\");\r\n          }\r\n        });\r\n      }, 500),\r\n    );\r\n\r\n    buttonViewAll.addEvent(\"click\", () => formContainer.submit());\r\n  }\r\n}\r\n\r\nwindow.Search = Search;\r\nconsole.log(\"search.js loaded\");\r\n"],
  "mappings": "MAAA,WAAa,CACX,YAAY,EAAW,CACrB,KAAK,KAAO,CACV,UAAW,EACX,cAAe,EAAU,cAAc,2BACvC,aAAc,EAAU,cAAc,mBACtC,iBAAkB,EAAU,cAAc,oBAG5C,KAAK,iBAGP,gBAAiB,CACf,GAAI,CAAE,eAAc,gBAAe,YAAW,oBAAqB,KAAK,KACpE,EAAe,EAAc,cAAc,yBAC3C,EAAgB,EAAiB,cAAc,iBAEnD,EAAa,SAAS,OAAQ,IAAM,CAClC,EAAU,YAAY,YAExB,EAAa,SAAS,QAAS,IAAM,CACnC,EAAU,SAAS,YAGrB,EAAa,SACX,QACA,GAAG,SAAS,IAAM,CAChB,GAAI,GAAQ,EAAa,MAAM,OAC/B,AAAI,CAAC,GAGL,GAAa,SAAS,WAEtB,MAAM,GAAG,MAAM,OAAO,4BAA4B,IAAQ,MAAM,SAAS,OAAO,YAAa,CAC3F,OAAQ,MACR,SAAU,OACV,QAAS,GAAI,WACZ,KAAK,AAAC,GAAS,CAChB,GAAI,CAAE,aAAc,EAChB,CAAE,WAAU,cAAc,GAAI,QAAQ,GAAI,WAAW,IAAO,EAAU,QAEtE,EAAe,OAAO,KAAK,EAAU,SAAS,OAAO,CAAC,EAAM,IACvD,EAAO,EAAU,QAAQ,GAAO,OACtC,GACH,GAAI,EAAc,CAChB,GAAI,GAAa,GACjB,EAAS,QAAQ,AAAC,GAChB,EAAW,KACT;AAAA,6BACa,EAAQ;AAAA,gCACL,GAAG,iBACb,EAAQ,eAAe,KAAO,MAAM,OAAO,aAC3C,iBACS,EAAQ;AAAA;AAAA;AAAA,+BAGR,EAAQ,6BAA6B,EAAQ;AAAA,yDAEtD,EAAQ,UAAa,GAAQ,MAAQ,KAAK,aAAe,MAAM,QAAQ;AAAA;AAAA,0BAOjF,EAAY,QAAQ,AAAC,GACnB,EAAW,KAAK;AAAA;AAAA;AAAA,4BAGF,GAAG,iBACb,EAAW,eAAe,KAAO,MAAM,OAAO,aAC9C,iBACS,EAAW;AAAA;AAAA;AAAA,2BAGX,EAAW,6BAA6B,EAAW;AAAA;AAAA;AAAA,gBAMlE,EAAS,QAAQ,AAAC,GAChB,EAAW,KAAK;AAAA;AAAA,2BAEH,EAAQ,6BAA6B,EAAQ;AAAA;AAAA,kBAK5D,EAAM,QAAQ,AAAC,GACb,EAAW,KAAK;AAAA;AAAA,2BAEH,EAAK,6BAA6B,EAAK;AAAA,wBAItD,EAAe,GAAK,EAAc,YAAY,UAAY,EAAc,SAAS,UACjF,QAAQ,IAAI,GAAY,KAAK,AAAC,GAAS,CACrC,EAAiB,iBAAiB,gBAAgB,QAAQ,AAAC,GAAS,EAAK,UACzE,EAAK,QAAQ,AAAC,GAAY,CACxB,GAAI,GAAM,SAAS,cAAc,OACjC,EAAI,UAAY,EAChB,EAAc,sBAAsB,cAAe,EAAI,qBAErD,MAAO,aAAe,aACxB,EACG,uBAAuB,YACvB,QAAQ,WAAW,gBAAgB,KAAK,aAE7C,EAAa,YAAY,WACzB,EAAiB,SAAS,eAC1B,EAAiB,YAAY,oBAG/B,GAAiB,YAAY,eAC7B,EAAiB,SAAS,cAC1B,EAAa,YAAY,eAG5B,MAGL,EAAc,SAAS,QAAS,IAAM,EAAc,YAIxD,OAAO,OAAS,EAChB,QAAQ,IAAI",
  "names": []
}
